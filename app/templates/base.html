<!doctype html>
<html lang="en" class="h-full"> <!-- Ensure h-full is on html -->

<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <!-- CSRF Token for JavaScript XHR -->
    <meta name="csrf" content="{{ csrf_token|default('') }}">
    <title>{% block title %}App{% endblock %}</title>
    <!-- Tailwind CSS - Load the BUILT CSS -->
    <!-- <link href="/static/styles.css" rel="stylesheet" /> --> <!-- OLD -->
    <link href="/static/dist/styles.css" rel="stylesheet" /> <!-- NEW -->
    <!-- Axios and Toast (loaded early for potential global use) -->
    <!-- Load the BUNDLED JS which includes api, toast, etc. -->
    <!-- <script defer src="/static/src/api.js"></script> --> <!-- OLD -->
    <!-- <script defer src="/static/src/ui/toast.js"></script> --> <!-- OLD -->
    <script type="module" src="/static/dist/js/main.js" defer></script> <!-- NEW -->
    {% block head %}{% endblock %}
</head>

<body class="min-h-screen bg-gray-50 text-gray-900"> <!-- Use min-h-screen -->
    <header class="border-b bg-white">
        <nav class="mx-auto max-w-6xl flex items-center justify-between p-4">
            <a href="/" class="font-semibold">Task & Note Manager</a>
            <ul class="flex gap-4 items-center">
                {% if current_user %}
                <li><a class="link" href="/dashboard">Dashboard</a></li>
                <li><a class="link" href="/tasks">Tasks</a></li>
                <li><a class="link" href="/notes">Notes</a></li>
                <li><a class="link" href="/collections">Collections</a></li>
                <li><a class="link" href="/tags">Tags</a></li>
                <li>
                    <!-- Simple form for logout -->
                    <form method="post" action="/web/logout">
                        <button class="btn" type="submit">Logout</button>
                    </form>
                </li>
                {% else %}
                <li><button data-open="login" class="btn">Login</button></li>
                <li><button data-open="register" class="btn-outline">Register</button></li>
                {% endif %}
            </ul>
        </nav>
    </header>

    <main class="mx-auto max-w-6xl p-4">
        {% block content %}{% endblock %}
    </main>

    <!-- Toast Container -->
    <div id="toasts" aria-live="polite" class="fixed bottom-4 right-4 flex flex-col gap-2 z-50"></div>

    {% block scripts %}{% endblock %}
</body>

</html>